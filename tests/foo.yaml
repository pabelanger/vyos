- hosts: controller
  tasks:
    - name: Install binary dependencies
      include_role:
        name: bindep

    - name: Run test-setup role
      include_role:
        name: test-setup

    - name: echo inventory
      shell: cat /etc/ansible/hosts

    - name: bootstrap venv
      shell: tox -evenv --notest
      args:
        chdir: ~/src/github.com/ansible-network/vyos

    - name: ansible
      shell: .tox/venv/bin/ansible-playbook -v -c network_cli tests/vyos.yaml
      args:
        chdir: ~/src/github.com/ansible-network/vyos
